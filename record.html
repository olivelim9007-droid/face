<!DOCTYPE html>
<html lang="ko">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
		<meta name="apple-mobile-web-app-status-bar-style" content="default">
		<title>기록</title>
		<link rel="stylesheet" href="./record-styles.css">
	</head>
	<body class="record-page">
	<div class="elem-2">
		<div class="elem-3">
			<div class="record-tab-bar elem-4">
				<div class="elem-5">
					<div class="elem-6">
						<a href="./record.html" class="elem-7" aria-current="page">
							<div class="elem-8">기록</div>
						</a>
						<a href="./index.html" class="elem-9">
							<div class="elem-10">카메라</div>
						</a>
						<a href="./feed.html" class="elem-11">
							<div class="elem-12">피드</div>
						</a>
					</div>
				</div>
			</div>
			<div class="elem-13">
				<div class="elem-14">
					<div class="elem-15">기록</div>
				</div>
				<div class="elem-16">
					<div class="elem-17 record-list-header">
						<div class="elem-18">최근 업로드</div>
						<button type="button" class="record-delete-all" id="record-delete-all" aria-label="전체 삭제">전체 삭제</button>
					</div>
					<div id="record-list"></div>
					<div id="record-empty" class="record-empty is-hidden">촬영한 사진이 없습니다.</div>
				</div>
			</div>
		</div>
	</div>
</body>
	<script>
		(function() {
			var RECORD_LIST_KEY = "skinRecordList";
			var listEl = document.getElementById("record-list");
			var emptyEl = document.getElementById("record-empty");
			var deleteAllBtn = document.getElementById("record-delete-all");
			if (!listEl) return;

			function getList() {
				var raw = localStorage.getItem(RECORD_LIST_KEY);
				var list = raw ? JSON.parse(raw) : [];
				list.sort(function(a, b) { return new Date(b.date) - new Date(a.date); });
				return list;
			}
			function saveList(list) {
				localStorage.setItem(RECORD_LIST_KEY, JSON.stringify(list));
			}
			function formatDate(iso) {
				var d = new Date(iso);
				var y = d.getFullYear();
				var m = String(d.getMonth() + 1).padStart(2, "0");
				var day = String(d.getDate()).padStart(2, "0");
				return y + "." + m + "." + day;
			}

			function render() {
				var list = getList();
				listEl.innerHTML = "";
				if (list.length === 0) {
					if (emptyEl) emptyEl.classList.remove("is-hidden");
					if (deleteAllBtn) deleteAllBtn.classList.add("is-hidden");
					return;
				}
				if (emptyEl) emptyEl.classList.add("is-hidden");
				if (deleteAllBtn) deleteAllBtn.classList.remove("is-hidden");

				list.forEach(function(item) {
					var row = document.createElement("div");
					row.className = "elem-19";
					var label = (item.label || "피부 진단").replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;");
					var dateStr = formatDate(item.date);
					row.innerHTML =
						"<div class=\"elem-20\">" +
						"<div class=\"elem-21\">" +
						"<div class=\"record-thumb\" role=\"img\" aria-label=\"기록 썸네일\"></div>" +
						"<div class=\"elem-23\">" + label + "</div>" +
						"</div>" +
						"<div class=\"elem-24\"><div class=\"elem-25\">" + dateStr + "</div></div>" +
						"</div>";
					var thumb = row.querySelector(".record-thumb");
					if (thumb && item.thumbnail) {
						var safeUrl = item.thumbnail.replace(/"/g, "\\22 ");
						thumb.style.backgroundImage = "url(\"" + safeUrl + "\")";
					}
					listEl.appendChild(row);
				});
			}

			if (deleteAllBtn) {
				deleteAllBtn.addEventListener("click", function() {
					var list = getList();
					if (list.length === 0) return;
					if (typeof confirm !== "undefined" && !confirm("전체 기록을 삭제할까요?")) return;
					saveList([]);
					render();
				});
			}

			render();
		})();
	</script>
	<script src="https://pages.oss.navercorp.com/UIT/figma-sync/plugin/prod/core/resize.js"></script>
</html>
